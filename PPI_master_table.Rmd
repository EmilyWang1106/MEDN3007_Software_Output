---
title: "PPI_master_table"
author: "Emily Wang"
date: "2023-10-08"
output: html_document
---

```{r}
library(dplyr)
library(tidyr)
library(readr)
library(data.table)
library(stringr)
library(bio3d)
library(reshape2)

```


# Prepare the sequences
```{r}
protein_names <- c("p53", "MDM2", "BRCA1", "BARD1", "Ras", "Raf", "ERK2","MKP3", "CyclinA",  "CDK2", "BRCA2", "RAD51","IL-2", "IL2-Ra", 'Tcf4',"Beta-Catenin", "E2F2", "RB","EGF","EGFR")
length(protein_names)

protein_seq <- c("MEEPQSDPSVEPPLSQETFSDLWKLLPENNVLSPLPSQAMDDLMLSPDDIEQWFTEDPGPDEAPRMPEAAPPVAPAPAAPTPAAPAPAPSWPLSSSVPSQKTYQGSYGFRLGFLHSGTAKSVTCTYSPALNKMFCQLAKTCPVQLWVDSTPPPGTRVRAMAIYKQSQHMTEVVRRCPHHERCSDSDGLAPPQHLIRVEGNLRVEYLDDRNTFRHSVVVPYEPPEVGSDCTTIHYNYMCNSSCMGGMNRRPILTIITLEDSSGNLLGRNSFEVRVCACPGRDRRTEEENLRKKGEPHHELPPGSTKRALPNNTSSSPQPKKKPLDGEYFTLQIRGRERFEMFRELNEALELKDAQAGKEPGGSRAHSSHLKSKKGQSTSRHKKLMFKTEGPDSD","MCNTNMSVPTDGAVTTSQIPASEQETLVRPKPLLLKLLKSVGAQKDTYTMKEVLFYLGQYIMTKRLYDEKQQHIVYCSNDLLGDLFGVPSFSVKEHRKIYTMIYRNLVVVNQQESSDSGTSVSENRCHLEGGSDQKDLVQELQEEKPSSSHLVSRPSTSSRRRAISETEENSDELSGERQRKRHKSDSISLSFDESLALCVIREICCERSSSSESTGTPSNPDLDAGVSEHSGDWLDQDSVSDQFSVEFEVESLDSEDYSLSEEGQELSDEDDEVYQVTVYQAGESDTDSFEEDPEISLADYWKCTSCNEMNPPLPSHCNRCWALRENWLPEDKGKDKGEISEKAKLENSTQAEEGFDVPDCKKTIVNDSRESCVEENDDKITQASQSQESEDYSQPSTSSSIIYSSQEDVKEFEREETQDKEESVESSLPLNAIEPCVICQGRPKNGCIVHGKTGHLMACFTCAKKLKKRNKPCPVCRQPIQMIVLTYFP", "MDLSALRVEEVQNVINAMQKILECPICLELIKEPVSTKCDHIFCKFCMLKLLNQKKGPSQCPLCKNDITKRSLQESTRFSQLVEELLKIICAFQLDTGLEYANSYNFAKKENNSPEHLKDEVSIIQSMGYRNRAKRLLQSEPENPSLQETSLSVQLSNLGTVRTLRTKQRIQPQKTSVYIELGSDSSEDTVNKATYCSVGDQELLQITPQGTRDEISLDSAKKAACEFSETDVTNTEHHQPSNNDLNTTEKRAAERHPEKYQGSSVSNLHVEPCGTNTHASSLQHENSSLLLTKDRMNVEKAEFCNKSKQPGLARSQHNRWAGSKETCNDRRTPSTEKKVDLNADPLCERKEWNKQKLPCSENPRDTEDVPWITLNSSIQKVNEWFSRSDELLGSDDSHDGESESNAKVADVLDVLNEVDEYSGSSEKIDLLASDPHEALICKSERVHSKSVESNIEDKIFGKTYRKKASLPNLSHVTENLIIGAFVTEPQIIQERPLTNKLKRKRRPTSGLHPEDFIKKADLAVQKTPEMINQGTNQTEQNGQVMNITNSGHENKTKGDSIQNEKNPNPIESLEKESAFKTKAEPISSSISNMELELNIHNSKAPKKNRLRRKSSTRHIHALELVVSRNLSPPNCTELQIDSCSSSEEIKKKKYNQMPVRHSRNLQLMEGKEPATGAKKSNKPNEQTSKRHDSDTFPELKLTNAPGSFTKCSNTSELKEFVNPSLPREEKEEKLETVKVSNNAEDPKDLMLSGERVLQTERSVESSSISLVPGTDYGTQESISLLEVSTLGKAKTEPNKCVSQCAAFENPKGLIHGCSKDNRNDTEGFKYPLGHEVNHSRETSIEMEESELDAQYLQNTFKVSKRQSFAPFSNPGNAEEECATFSAHSGSLKKQSPKVTFECEQKEENQGKNESNIKPVQTVNITAGFPVVGQKDKPVDNAKCSIKGGSRFCLSSQFRGNETGLITPNKHGLLQNPYRIPPLFPIKSFVKTKCKKNLLEENFEEHSMSPEREMGNENIPSTVSTISRNNIRENVFKEASSSNINEVGSSTNEVGSSINEIGSSDENIQAELGRNRGPKLNAMLRLGVLQPEVYKQSLPGSNCKHPEIKKQEYEEVVQTVNTDFSPYLISDNLEQPMGSSHASQVCSETPDDLLDDGEIKEDTSFAENDIKESSAVFSKSVQKGELSRSPSPFTHTHLAQGYRRGAKKLESSEENLSSEDEELPCFQHLLFGKVNNIPSQSTRHSTVATECLSKNTEENLLSLKNSLNDCSNQVILAKASQEHHLSEETKCSASLFSSQCSELEDLTANTNTQDPFLIGSSKQMRHQSESQGVGLSDKELVSDDEERGTGLEENNQEEQSMDSNLGEAASGCESETSVSEDCSGLSSQSDILTTQQRDTMQHNLIKLQQEMAELEAVLEQHGSQPSNSYPSIISDSSALEDLRNPEQSTSEKAVLTSQKSSEYPISQNPEGLSADKFEVSADSSTSKNKEPGVERSSPSKCPSLDDRWYMHSCSGSLQNRNYPSQEELIKVVDVEEQQLEESGPHDLTETSYLPRQDLEGTPYLESGISLFSDDPESDPSEDRAPESARVGNIPSSTSALKVPQLKVAESAQSPAAAHTTDTAGYNAMEESVSREKPELTASTERVNKRMSMVVSGLTPEEFMLVYKFARKHHITLTNLITEETTHVVMKTDAEFVCERTLKYFLGIAGGKWVVSYFWVTQSIKERKMLNEHDFEVRGDVVNGRNHQGPKRARESQDRKIFRGLEICCYGPFTNMPTDQLEWMVQLCGASVVKELSSFTLGTGVHPIVVVQPDAWTEDNGFHAIGQMCEAPVVTREWVLDSVALYQCQELDTYLIPQIPHSHY","MPDNRQPRNRQPRIRSGNEPRSAPAMEPDGRGAWAHSRAALDRLEKLLRCSRCTNILREPVCLGGCEHIFCSNCVSDCIGTGCPVCYTPAWIQDLKINRQLDSMIQLCSKLRNLLHDNELSDLKEDKPRKSLFNDAGNKKNSIKMWFSPRSKKVRYVVSKASVQTQPAIKKDASAQQDSYEFVSPSPPADVSERAKKASARSGKKQKKKTLAEINQKWNLEAEKEDGEFDSKEESKQKLVSFCSQPSVISSPQINGEIDLLASGSLTESECFGSLTEVSLPLAEQIESPDTKSRNEVVTPEKVCKNYLTSKKSLPLENNGKRGHHNRLSSPISKRCRTSILSTSGDFVKQTVPSENIPLPECSSPPSCKRKVGGTSGRKNSNMSDEFISLSPGTPPSTLSSSSYRRVMSSPSAMKLLPNMAVKRNHRGETLLHIASIKGDIPSVEYLLQNGSDPNVKDHAGWTPLHEACNHGHLKVVELLLQHKALVNTTGYQNDSPLHDAAKNGHVDIVKLLLSYGASRNAVNIFGLRPVDYTDDESMKSLLLLPEKNESSSASHCSVMNTGQRRDGPLVLIGSGLSSEQQKMLSELAVILKAKKYTEFDSTVTHVVVPGDAVQSTLKCMLGILNGCWILKFEWVKACLRRKVCEQEEKYEIPEGPRRSRLNREQLLPKLFDGCYFYLWGTFKHHPKDNLIKLVTAGGGQILSRKPKPDSDVTQTINTVAYHARPDSDQRFCTQYIIYEDLCNYHPERVRQGKVWKAPSSWFIDCVMSFELLPLDS","MTEYKLVVVGAGGVGKSALTIQLIQNHFVDEYDPTIEDSYRKQVVIDGETCLLDILDTAGQEEYSAMRDQYMRTGEGFLCVFAINNTKSFEDIHQYREQIKRVKDSDDVPMVLVGNKCDLAARTVESRQAQDLARSYGIPYIETSAKTRQGVEDAFYTLVREIRQHKLRKLNPPDESGPGCMSCKCVLS",
"MEHIQGAWKTISNGFGFKDAVFDGSSCISPTIVQQFGYQRRASDDGKLTDPSKTSNTIRVFLPNKQRTVVNVRNGMSLHDCLMKALKVRGLQPECCAVFRLLHEHKGKKARLDWNTDAASLIGEELQVDFLDHVPLTTHNFARKTFLKLAFCDICQKFLLNGFRCQTCGYKFHEHCSTKVPTMCVDWSNIRQLLLFPNSTIGDSGVPALPSLTMRRMRESVSRMPVSSQHRYSTPHAFTFNTSSPSSEGSLSQRQRSTSTPNVHMVSTTLPVDSRMIEDAIRSHSESASPSALSSSPNNLSPTGWSQPKTPVPAQRERAPVSGTQEKNKIRPRGQRDSSYYWEIEASEVMLSTRIGSGSFGTVYKGKWHGDVAVKILKVVDPTPEQFQAFRNEVAVLRKTRHVNILLFMGYMTKDNLAIVTQWCEGSSLYKHLHVQETKFQMFQLIDIARQTAQGMDYLHAKNIIHRDMKSNNIFLHEGLTVKIGDFGLATVKSRWSGSQQVEQPTGSVLWMAPEVIRMQDNNPFSFQSDVYSYGIVLYELMTGELPYSHINNRDQIIFMVGRGYASPDLSKLYKNCPKAMKRLVADCVKKVKEERPLFPQILSSIELLQHSLPKINRSASEPSLHRAAHTEDINACTLTTSPRLPVF","MAAAAAAGAGPEMVRGQVFDVGPRYTNLSYIGEGAYGMVCSAYDNVNKVRVAIKKISPFEHQTYCQRTLREIKILLRFRHENIIGINDIIRAPTIEQMKDVYIVQDLMETDLYKLLKTQHLSNDHICYFLYQILRGLKYIHSANVLHRDLKPSNLLLNTTCDLKICDFGLARVADPDHDHTGFLTEYVATRWYRAPEIMLNSKGYTKSIDIWSVGCILAEMLSNRPIFPGKHYLDQLNHILGILGSPSQEDLNCIINLKARNYLLSLPHKNKVPWNRLFPNADSKALDLLDKMLTFNPHKRIEVEQALAHPYLEQYYDPSDEPIAEAPFKFDMELDDLPKEKLKELIFEETARFQPGYRS","MIDTLRPVPFASEMAISKTVAWLNEQLELGNERLLLMDCRPQELYESSHIESAINVAIPGIMLRRLQKGNLPVRALFTRGEDRDRFTRRCGTDTVVLYDESSSDWNENTGGESVLGLLLKKLKDEGCRAFYLEGGFSKFQAEFSLHCETNLDGSCSSSSPPLPVLGLGGLRISSDSSSDIESDLDRDPNSATDSDGSPLSNSQPSFPVEILPFLYLGCAKDSTNLDVLEEFGIKYILNVTPNLPNLFENAGEFKYKQIPISDHWSQNLSQFFPEAISFIDEARGKNCGVLVHCLAGISRSVTVTVAYLMQKLNLSMNDAYDIVKMKKSNISPNFNFMGQLLDFERTLGLSSPCDNRVPAQQLYFTTPSNQNVYQVDSLQST", "MLGNSAPGPATREAGSALLALQQTALQEDQENINPEKAAPVQQPRTRAALAVLKSGNPRGLAQQQRPKTRRVAPLKDLPVNDEHVTVPPWKANSKQPAFTIHVDEAEKEAQKKPAESQKIEREDALAFNSAISLPGPRKPLVPLDYPMDGSFESPHTMDMSIILEDEKPVSVNEVPDYHEDIHTYLREMEVKCKPKVGYMKKQPDITNSMRAILVDWLVEVGEEYKLQNETLHLAVNYIDRFLSSMSVLRGKLQLVGTAAMLLASKFEEIYPPEVAEFVYITDDTYTKKQVLRMEHLVLKVLTFDLAAPTVNQFLTQYFLHQQPANCKVESLAMFLGELSLIDADPYLKYLPSVIAGAAFHLALYTVTGQSWPESLIRKTGYTLESLKPCLMDLHQTYLKAPQHAQQSIREKYKNSKYHGVSLLNPPETLNL", "MENFQKVEKIGEGTYGVVYKARNKLTGEVVALKKIRLDTETEGVPSTAIREISLLKELNHPNIVKLLDVIHTENKLYLVFEFLHQDLKKFMDASALTGIPLPLIKSYLFQLLQGLAFCHSHRVLHRDLKPQNLLINTEGAIKLADFGLARAFGVPVRTYTHEVVTLWYRAPEILLGCKYYSTAVDIWSLGCIFAEMVTRRALFPGDSEIDQLFRIFRTLGTPDEVVWPGVTSMPDYKPSFPKWARQDFSKVVPPLDEDGRSLLSQMLHYDPNKRISAKAALAHPFFQDVTKPVPHLRL",
"MPIGSKERPTFFEIFKTRCNKADLGPISLNWFEELSSEAPPYNSEPAEESEHKNNNYEPNLFKTPQRKPSYNQLASTPIIFKEQGLTLPLYQSPVKELDKFKLDLGRNVPNSRHKSLRTVKTKMDQADDVSCPLLNSCLSESPVVLQCTHVTPQRDKSVVCGSLFHTPKFVKGRQTPKHISESLGAEVDPDMSWSSSLATPPTLSSTVLIVRNEEASETVFPHDTTANVKSYFSNHDESLKKNDRFIASVTDSENTNQREAASHGFGKTSGNSFKVNSCKDHIGKSMPNVLEDEVYETVVDTSEEDSFSLCFSKCRTKNLQKVRTSKTRKKIFHEANADECEKSKNQVKEKYSFVSEVEPNDTDPLDSNVANQKPFESGSDKISKEVVPSLACEWSQLTLSGLNGAQMEKIPLLHISSCDQNISEKDLLDTENKRKKDFLTSENSLPRISSLPKSEKPLNEETVVNKRDEEQHLESHTDCILAVKQAISGTSPVASSFQGIKKSIFRIRESPKETFNASFSGHMTDPNFKKETEASESGLEIHTVCSQKEDSLCPNLIDNGSWPATTTQNSVALKNAGLISTLKKKTNKFIYAIHDETSYKGKKIPKDQKSELINCSAQFEANAFEAPLTFANADSGLLHSSVKRSCSQNDSEEPTLSLTSSFGTILRKCSRNETCSNNTVISQDLDYKEAKCNKEKLQLFITPEADSLSCLQEGQCENDPKSKKVSDIKEEVLAAACHPVQHSKVEYSDTDFQSQKSLLYDHENASTLILTPTSKDVLSNLVMISRGKESYKMSDKLKGNNYESDVELTKNIPMEKNQDVCALNENYKNVELLPPEKYMRVASPSRKVQFNQNTNLRVIQKNQEETTSISKITVNPDSEELFSDNENNFVFQVANERNNLALGNTKELHETDLTCVNEPIFKNSTMVLYGDTGDKQATQVSIKKDLVYVLAEENKNSVKQHIKMTLGQDLKSDISLNIDKIPEKNNDYMNKWAGLLGPISNHSFGGSFRTASNKEIKLSEHNIKKSKMFFKDIEEQYPTSLACVEIVNTLALDNQKKLSKPQSINTVSAHLQSSVVVSDCKNSHITPQMLFSKQDFNSNHNLTPSQKAEITELSTILEESGSQFEFTQFRKPSYILQKSTFEVPENQMTILKTTSEECRDADLHVIMNAPSIGQVDSSKQFEGTVEIKRKFAGLLKNDCNKSASGYLTDENEVGFRGFYSAHGTKLNVSTEALQKAVKLFSDIENISEETSAEVHPISLSSSKCHDSVVSMFKIENHNDKTVSEKNNKCQLILQNNIEMTTGTFVEEITENYKRNTENEDNKYTAASRNSHNLEFDGSDSSKNDTVCIHKDETDLLFTDQHNICLKLSGQFMKEGNTQIKEDLSDLTFLEVAKAQEACHGNTSNKEQLTATKTEQNIKDFETSDTFFQTASGKNISVAKESFNKIVNFFDQKPEELHNFSLNSELHSDIRKNKMDILSYEETDIVKHKILKESVPVGTGNQLVTFQGQPERDEKIKEPTLLGFHTASGKKVKIAKESLDKVKNLFDEKEQGTSEITSFSHQWAKTLKYREACKDLELACETIEITAAPKCKEMQNSLNNDKNLVSIETVVPPKLLSDNLCRQTENLKTSKSIFLKVKVHENVEKETAKSPATCYTNQSPYSVIENSALAFYTSCSRKTSVSQTSLLEAKKWLREGIFDGQPERINTADYVGNYLYENNSNSTIAENDKNHLSEKQDTYLSNSSMSNSYSYHSDEVYNDSGYLSKNKLDSGIEPVLKNVEDQKNTSFSKVISNVKDANAYPQTVNEDICVEELVTSSSPCKNKNAAIKLSISNSNNFEVGPPAFRIASGKIVCVSHETIKKVKDIFTDSFSKVIKENNENKSKICQTKIMAGCYEALDDSEDILHNSLDNDECSTHSHKVFADIQSEEILQHNQNMSGLEKVSKISPCDVSLETSDICKCSIGKLHKSVSSANTCGIFSTASGKSVQVSDASLQNARQVFSEIEDSTKQVFSKVLFKSNEHSDQLTREENTAIRTPEHLISQKGFSYNVVNSSAFSGFSTASGKQVSILESSLHKVKGVLEEFDLIRTEHSLHYSPTSRQNVSKILPRVDKRNPEHCVNSEMEKTCSKEFKLSNNLNVEGGSSENNHSIKVSPYLSQFQQDKQQLVLGTKVSLVENIHVLGKEQASPKNVKMEIGKTETFSDVPVKTNIEVCSTYSKDSENYFETEAVEIAKAFMEDDELTDSKLPSHATHSLFTCPENEEMVLSNSRIGKRRGEPLILVGEPSIKRNLLNEFDRIIENQEKSLKASKSTPDGTIKDRRLFMHHVSLEPITCVPFRTTKERQEIQNPNFTAPGQEFLSKSHLYEHLTLEKSSSNLAVSGHPFYQVSATRNEKMRHLITTGRPTKVFVPPFKTKSHFHRVEQCVRNINLEENRQKQNIDGHGSDDSKNKINDNEIHQFNKNNSNQAVAVTFTKCEEEPLDLITSLQNARDIQDMRIKKKQRQRVFPQPGSLYLAKTSTLPRISLKAAVGGQVPSACSHKQLYTYGVSKHCIKINSKNAESFQFHTEDYFGKESLWTGKGIQLADGGWLIPSNDGKAGKEEFYRALCDTPGVDPKLISRIWVYNHYRWIIWKLAAMECAFPKEFANRCLSPERVLLQLKYRYDTEIDRSRRSAIKKIMERDDTAAKTLVLCVSDIISLSANISETSSNKTSSADTQKVAIIELTDGWYAVKAQLDPPLLAVLKNGRLTVGQKIILHGAELVGSPDACTPLEAPESLMLKISANSTRPARWYTKLGFFPDPRPFPLPLSSLFSDGGNVGCVDVIIQRAYPIQWMEKTSSGLYIFRNEREEEKEAAKYVEAQQKRLEALFTKIQEEFEEHEENTTKPYLPSRALTRQQVRALQDGAELYEAVKNAADPAYLEGYFSEEQLRALNNHRQMLNDKKQAQIQLEIRKAMESAEQKEQGLSRDVTTVWKLRIVSYSKKEKDSVILSIWRPSSDLYSLLTEGKRYRIYHLATSKSKSKSERANIQLAATKKTQYQQLPVSDEILFQIYQPREPLHFSKFLDPDFQPSCSEVDLIGFVVSVVKKTGLAPFVYLSDECYNLLAIKFWIDLNEDIIKPHMLIAASNLQWRPESKSGLLTLFAGDFSVFSASPKEGHFQETFNKMKNTVENIDILCNEAENKLMHILHANDPKWSTPTKDCTSGPYTAQIIPGTGNKLLMSSPNCEIYYQSPLSLCMAKRKSVSTPVSAQMTSKSCKGEKEIDDQKNCKKRRALDFLSRLPLPPPVSPICTFVSPAAQKAFQPPRSCGTKYETPIKKKELNSPQMTPFKKFNEISLLESNSIADEELALINTQALLSGSTGEKQFISVSESTRTAPTSSEDYLRLKRRCTTSLIKEQESSQASTEECEKNKQDTITTKKYI",
"MAMQMQLEANADTSVEEESFGPQPISRLEQCGINANDVKKLEEAGFHTVEAVAYAPKKELINIKGISEAKADKILAEAAKLVPMGFTTATEFHQRRSEIIQITTGSKELDKLLQGGIETGSITEMFGEFRTGKTQICHTLAVTCQLPIDRGGGEGKAMYIDTEGTFRPERLLAVAERYGLSGSDVLDNVAYARAFNTDHQTQLLYQASAMMVESRYALLIVDSATALYRTDYSGRGELSARQMHLARFLRMLLRLADEFGVAVVITNQVVAQVDGAAMFAADPKKPIGGNIIAHASTTRLYLRKGRGETRICKIYDSPCLPEAEAMFAINADGVGDAKD",
"MYRMQLLSCIALSLALVTNSAPTSSSTKKTQLQLEHLLLDLQMILNGINNYKNPKLTRMLTFKFYMPKKATELKHLQCLEEELKPLEEVLNLAQSKNFHLRPRDLISNINVIVLELKGSETTFMCEYADETATIVEFLNRWITFCQSIISTLT", "MDSYLLMWGLLTFIMVPGCQAELCDDDPPEIPHATFKAMAYKEGTMLNCECKRGFRRIKSGSLYMLCTGNSSHSSWDNQCQCTSSATRNTTKQVTPQPEEQKERKTTEMQSPMQPVDQASLPGHCREPPPWENEATERIYHFVVGQMVYYQCVQGYRALHRGPAESVCKMTHGKTRWTQPQLICTGEMETSQFPGEEKPQASPEGRPESETSCLVTTTDFQIQTEMAATMETSIFTTEYQVAVAGCVFLLISVLLLSGLTWQRRQRKSRRTI", "MHHQQRMAALGTDKELSDLLDFSAMFSPPVSSGKNGPTSLASGHFTGSNVEDRSSSGSWGNGGHPSPSRNYGDGTPYDHMTSRDLGSHDNLSPPFVNSRIQSKTERGSYSSYGRESNLQGCHQQSLLGGDMDMGNPGTLSPTKPGSQYYQYSSNNPRRRPLHSSAMEVQTKKVRKVPPGLPSSVYAPSASTADYNRDSPGYPSSKPATSTFPSSFFMQDGHHSSDPWSSSSGMNQPGYAGMLGNSSHIPQSSSYCSLHPHERLSYPSHSSADINSSLPPMSTFHRSGTNHYSTSSCTPPANGTDSIMANRGSGAAGSSQTGDALGKALASIYSPDHTNNSFSSNPSTPVGSPPSLSAGTAVWSRNGGQASSSPNYEGPLHSLQSRIEDRLERLDDAIHVLRNHAVGPSTAMPGGHGDMHGIIGPSHNGAMGGLGSGYGTGLLSANRHSLMVGTHREDGVALRGSHSLLPNQVPVPQLPVQSATSPDLNPPQDPYRGMPPGLQGQSVSSGSSEIKSDDEGDENLQDTKSSEDKKLDDDKKDIKSITSNNDDEDLTPEQKAEREKERRMANNARERLRVRDINEAFKELGRMVQLHLKSDKPQTKLLILHQAVAVILSLEQQVRERNLNPKAACLKRREEEKVSSEPPPLSLAGPHPGMGDASNHMGQM",
"MATQADLMELDMAMEPDRKAAVSHWQQQSYLDSGIHSGATTTAPSLSGKGNPEEEDVDTSQVLYEWEQGFSQSFTQEQVADIDGQYAMTRAQRVRAAMFPETLDEGMQIPSTQFDAAHPTNVQRLAEPSQMLKHAVVNLINYQDDAELATRAIPELTKLLNDEDQVVVNKAAVMVHQLSKKEASRHAIMRSPQMVSAIVRTMQNTNDVETARCTAGTLHNLSHHREGLLAIFKSGGIPALVKMLGSPVDSVLFYAITTLHNLLLHQEGAKMAVRLAGGLQKMVALLNKTNVKFLAITTDCLQILAYGNQESKLIILASGGPQALVNIMRTYTYEKLLWTTSRVLKVLSVCSSNKPAIVEAGGMQALGLHLTDPSQRLVQNCLWTLRNLSDAATKQEGMEGLLGTLVQLLGSDDINVVTCAAGILSNLTCNNYKNKMMVCQVGGIEALVRTVLRAGDREDITEPAICALRHLTSRHQEAEMAQNAVRLHYGLPVVVKLLHPPSHWPLIKATVGLIRNLALCPANHAPLREQGAIPRLVQLLVRAHQDTQRRTSMGGTQQQFVEGVRMEEIVEGCTGALHILARDVHNRIVIRGLNTIPLFVQLLYSPIENIQRVAAGVLCELAQDKEAAEAIEAEGATAPLTELLHSRNEGVATYAAAVLFRMSEDKPQDYKKRLSVELTSSLFRTEPMAWNETADLGLDIGAQGEPLGYRQDDPSYRSFHSGGYGQDALGMDPMMEHEMGGHHPGADYPVDGLPDLGHAQDLMDGLPPGDSNQLAWFDTDL", "MLQGPRALASAAGQTPKVVPAMSPTELWPSGLSSPQLCPATATYYTPLYPQTAPPAAAPGTCLDATPHGPEGQVVRCLPAGRLPAKRKLDLEGIGRPVVPEFPTPKGKCIRVDGLPSPKTPKSPGEKTRYDTSLGLLTKKFIYLLSESEDGVLDLNWAAEVLDVQKRRIYDITNVLEGIQLIRKKAKNNIQWVGRGMFEDPTRPGKQQQLGQELKELMNTEQALDQLIQSCSLSFKHLTEDKANKRLAYVTYQDIRAVGNFKEQTVIAVKAPPQTRLEVPDRTEDNLQIYLKSTQGPIEVYLCPEEVQEPDSPSEEPLPSTSTLCPSPDSAQPSSSTDPSIMEPTASSVPAPAPTPQQAPPPPSLVPLEATDSLLELPHPLLQQTEDQFLSPTLACSSPLISFSPSLDQDDYLWGLEAGEGISDLFDSYDLGDLLIN", "MPPKTPRKTAATAAAAAAEPPAPPPPPPPEEDPEQDSGPEDLPLVRLEFEETEEPDFTALCQKLKIPDHVRERAWLTWEKVSSVDGVLGGYIQKKKELWGICIFIAAVDLDEMSFTFTELQKNIEISVHKFFNLLKEIDTSTKVDNAMSRLLKKYDVLFALFSKLERTCELIYLTQPSSSISTEINSALVLKVSWITFLLAKGEVLQMEDDLVISFQLMLCVLDYFIKLSPPMLLKEPYKTAVIPINGSPRTPRRGQNRSARIAKQLENDTRIIEVLCKEHECNIDEVKNVYFKNFIPFMNSLGLVTSNGLPEVENLSKRYEEIYLKNKDLDARLFLDHDKTLQTDSIDSFETQRTPRKSNLDEEVNVIPPHTPVRTVMNTIQQLMMILNSASDQPSENLISYFNNCTVNPKESILKRVKDIGYIFKEKFAKAVGQGCVEIGSQRYKLGVRLYYRVMESMLKSEEERLSIQNFSKLLNDNIFHMSLLACALEVVMATYSRSTSQNLDSGTDLSFPWILNVLNLKAFDFYKVIESFIKAEGNLTREMIKHLERCEHRIMESLAWLSDSPLFDLIKQSKDREGPTDHLESACPLNLPLQNNHTAADMYLSPVRSPKKKGSTTRVNSTANAETQATSAFQTQKPLKSTSLSLFYKKVYRLAYLRLNTLCERLLSEHPELEHIIWTLFQHTLQNEYELMRDRHLDQIMMCSMYGICKVKNIDLKFKIIVTAYKDLPHAVQETFKRVLIKEEEYDSIIVFYNSVFMQRLKTNILQYASTRPPTLSPIPHIPRSPYKFPSSPLRIPGGNIYISPLKSPYKISEGLPTPTKMTPRSRILVSIGESFGTSEKFQKINQMVCNSDRVLKRSAEGSNPPKPLKKLRFDIEGSDEADGSKHLPGESKFQQKLAEMTSTRTRMQKQKMNDSMDTSNKEEK", 
"MLLTLIILLPVVSKFSFVSLSAPQHWSCPEGTLAGNGNSTCVGPAPFLIFSHGNSIFRIDTEGTNYEQLVVDAGVSVIMDFHYNEKRIYWVDLERQLLQRVFLNGSRQERVCNIEKNVSGMAINWINEEVIWSNQQEGIITVTDMKGNNSHILLSALKYPANVAVDPVERFIFWSSEVAGSLYRADLDGVGVKALLETSEKITAVSLDVLDKRLFWIQYNREGSNSLICSCDYDGGSVHISKHPTQHNLFAMSLFGDRIFYSTWKMKTIWIANKHTGKDMVRINLHSSFVPLGELKVVHPLAQPKAEDDTWEPEQKLCKLRKGNCSSTVCGQDLQSHLCMCAEGYALSRDRKYCEDVNECAFWNHGCTLGCKNTPGSYYCTCPVGFVLLPDGKRCHQLVSCPRNVSECSHDCVLTSEGPLCFCPEGSVLERDGKTCSGCSSPDNGGCSQLCVPLSPVSWECDCFPGYDLQLDEKSCAASGPQPFLLFANSQDIRHMHFDGTDYGTLLSQQMGMVYALDHDPVENKIYFAHTALKWIERANMDGSQRERLIEEGVDVPEGLAVDWIGRRFYWTDRGKSLIGRSDLNGKRSKIITKENISQPRGIAVHPMAKRLFWTDTGINPRIESSSLQGLGRLVIASSDLIWPSGITIDFLTDKLYWCDAKQSVIEMANLDGSKRRRLTQNDVGHPFAVAVFEDYVWFSDWAMPSVMRVNKRTGKDRVRLQGSMLKPSSLVVVHPLAKPGADPCLYQNGGCEHICKKRLGTAWCSCREGFMKASDGKTCLALDGHQLLAGGEVDLKNQVTPLDILSKTRVSEDNITESQHMLVAEIMVSDQDDCAPVGCSMYARCISEGEDATCQCLKGFAGDGKLCSDIDECEMGVPVCPPASSKCINTEGGYVCRCSEGYQGDGIHCLDIDECQLGEHSCGENASCTNTEGGYTCMCAGRLSEPGLICPDSTPPPHLREDDHHYSVRNSDSECPLSHDGYCLHDGVCMYIEALDKYACNCVVGYIGERCQYRDLKWWELRHAGHGQQQKVIVVAVCVVVLVMLLLLSLWGAHYYRTQKLLSKNPKNPYEESSRDVRSRRPADTEDGMSSCPQPWFVVIKEHQDLKNGGQPVAGEDGQAADGSMQPTSWRQEPQLCGMGTEQGCWIPVSSDKGSCPQVMERSFHMPSYGTQTLEGGVEKPHSLLSANPLWQQRALDPPHQMELTQ", "MRPSGTAGAALLALLAALCPASRALEEKKVCQGTSNKLTQLGTFEDHFLSLQRMFNNCEVVLGNLEITYVQRNYDLSFLKTIQEVAGYVLIALNTVERIPLENLQIIRGNMYYENSYALAVLSNYDANKTGLKELPMRNLQEILHGAVRFSNNPALCNVESIQWRDIVSSDFLSNMSMDFQNHLGSCQKCDPSCPNGSCWGAGEENCQKLTKIICAQQCSGRCRGKSPSDCCHNQCAAGCTGPRESDCLVCRKFRDEATCKDTCPPLMLYNPTTYQMDVNPEGKYSFGATCVKKCPRNYVVTDHGSCVRACGADSYEMEEDGVRKCKKCEGPCRKVCNGIGIGEFKDSLSINATNIKHFKNCTSISGDLHILPVAFRGDSFTHTPPLDPQELDILKTVKEITGFLLIQAWPENRTDLHAFENLEIIRGRTKQHGQFSLAVVSLNITSLGLRSLKEISDGDVIISGNKNLCYANTINWKKLFGTSGQKTKIISNRGENSCKATGQVCHALCSPEGCWGPEPRDCVSCRNVSRGRECVDKCNLLEGEPREFVENSECIQCHPECLPQAMNITCTGRGPDNCIQCAHYIDGPHCVKTCPAGVMGENNTLVWKYADAGHVCHLCHPNCTYGCTGPGLEGCPTNGPKIPSIATGMVGALLLLLVVALGIGLFMRRRHIVRKRTLRRLLQERELVEPLTPSGEAPNQALLRILKETEFKKIKVLGSGAFGTVYKGLWIPEGEKVKIPVAIKELREATSPKANKEILDEAYVMASVDNPHVCRLLGICLTSTVQLITQLMPFGCLLDYVREHKDNIGSQYLLNWCVQIAKGMNYLEDRRLVHRDLAARNVLVKTPQHVKITDFGLAKLLGAEEKEYHAEGGKVPIKWMALESILHRIYTHQSDVWSYGVTVWELMTFGSKPYDGIPASEISSILEKGERLPQPPICTIDVYMIMVKCWMIDADSRPKFRELIIEFSKMARDPQRYLVIQGDERMHLPSPTDSNFYRALMDEEDMDDVVDADEYLIPQQGFFSSPSTSRTPLLSSLSATSNNSTVACIDRNGLQSCPIKEDSFLQRYSSDPTGALTEDSIDDTFLPVPEYINQSVPKRPAGSVQNPVYHNQPLNPAPSRDPHYQDPHSTAVGNPEYLNTVQPTCVNSTFDSPAHWAQKGSHQISLDNPDYQQDFFPKEAKPNGIFKGSTAENAEYLRVAPQSSEFIGA")

length(protein_seq)

protein_data <- setNames(protein_seq, protein_names)


```

#Match the uniportID with protein names 
```{r}
uniportID <-c('P04637', "Q00987", "P38398", "Q99728", "P01112", "P04049", "P28482", "Q16828", "P20248", "P24941", "P51587", "Q06609", "P60568", "P01589", "P15884", "P35222", "Q14209", "P06400", "P01133", "P00533")

protein_pp <- data.frame(protein_names,uniportID)
```


##Construct Master_table 
```{r}
SA_sec_structure_table <- fread("/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_SA_2Structure/PPI_SA_2Structure.csv")

Master_table<- data_frame(SA_sec_structure_table$id, SA_sec_structure_table$seq, SA_sec_structure_table$n,SA_sec_structure_table$rsa, SA_sec_structure_table$asa, SA_sec_structure_table$q3)

colnames(Master_table)[colnames(Master_table) %in% c("SA_sec_structure_table$id", "SA_sec_structure_table$seq", "SA_sec_structure_table$n", "SA_sec_structure_table$rsa", "SA_sec_structure_table$asa", "SA_sec_structure_table$q3")] <- c("protein_A", "aa_ref", "aa_position", "rsa", "asa", "sec_structure")

Master_table$protein_A <- sub("^>", "", Master_table$protein_A)

```


# Change the amino acids to follow hydrophobic order
```{r}
# Order of amino acids by hydrophobicity
aa_by_hydrophobicity <- c("R", "K", "D", "E", "Q", "N", "H", "P", "Y", "W", "S", "T", "G", "A", "M", "C", "F", "L", "V", "I")

# Replicate each row of Master_table 20 times
expanded_table <- Master_table[rep(row.names(Master_table), each = length(aa_by_hydrophobicity)),]

# Attach the aa_by_hydrophobicity to the expanded table
expanded_table$aa_alt <- rep(aa_by_hydrophobicity, nrow(Master_table))

# This will now be the expanded Master_table
Master_table <- expanded_table

Master_table <- Master_table %>%
  relocate(aa_alt, .before = 4)

setDT(Master_table)

Master_table[protein_pp, uniprot := uniportID, on = c(protein_A = "protein_names")]

colnames(Master_table)[colnames(Master_table) == "aa_position"] <- "aa_pos"  
```


##Add esm1b score
```{r}

# Folder path
folder_path <- "/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_ESM1b"
files <- list.files(path = folder_path, pattern = "*.csv", full.names = TRUE)

# Iterate over each file
for (file in files) {
  # Read the CSV file
  df <- read_csv(file)
  
  # Extract the protein name (part of the file name before the underscore)
  protein_name <- strsplit(tools::file_path_sans_ext(basename(file)), "_")[[1]][1]
  
  # Add the protein_A column
  df$protein_A <- protein_name
  
  # Split the variant column
  df <- df %>%
    separate(variant, into = c("aa_ref", "aa_pos", "aa_alt"), sep = "(?<=^[A-Za-z])(?=\\d)|(?<=\\d)(?=[A-Za-z])")|>
  mutate(aa_pos = as.integer(aa_pos))
  
  setDT(df)
  
  # Left join the data from the file to the Master_table
  Master_table[df, ESM_score:= score, on = c(protein_A = "protein_A", aa_alt = "aa_alt", aa_pos = "aa_pos", aa_ref = "aa_ref")]
  
}

# If there are multiple CSV files with the same variants, the resulting score column will have suffixes (e.g., score.x, score.y). 
# Depending on your data, you might want to handle these suffixes or keep only the first non-NA score. 
```

##gnomAD allele frequency 
```{r}

folder_path <- "/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_gnomad"
files <- list.files(path = folder_path, pattern = "*.csv", full.names = TRUE)

for (file in files) {
  # Read the CSV file
  df <- fread(file)
  
  # Extract protein name from file name
  protein_name <- strsplit(tools::file_path_sans_ext(basename(file)), "_")[[1]][1]
  df$protein_A <- protein_name
  
  # Extract amino acid position
  df$aa_pos <- as.integer(str_extract(df$`Protein Consequence`, "\\d+"))
  
  setDT(df)
  # Left join to the Master_table
  Master_table[df, allele_frequency:= `Allele Frequency`, on = c(protein_A = "protein_A", aa_alt = "Alternate", aa_pos = "aa_pos", aa_ref = "Reference")]
}

Master_table$allele_frequency[is.na(Master_table$allele_frequency)]<- 0

```



##polyphen
```{r}
folder_path <- "/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_polyphen"
files <- list.files(path = folder_path, pattern = "*.txt", full.names = TRUE)

for (file in files) {
  # Read the CSV file
  df <- fread(file)
  
  # Extract protein name from file name
  protein_name <- strsplit(tools::file_path_sans_ext(basename(file)), "_")[[1]][1]
  df$protein_A <- protein_name
  
  # Extract amino acid position
  df$aa_pos <- as.integer(df$o_pos)
  
  setDT(df)
  # Left join to the Master_table
  Master_table[df, polyphen:= pph2_prob, on = c(protein_A = "protein_A", aa_alt = "o_aa2", aa_pos = "o_pos", aa_ref = "o_aa1")]
}


# Set polyphen to 0 if aa_alt equals aa_ref and polyphen is NA
Master_table[is.na(polyphen) & aa_alt == aa_ref, polyphen := 0]

```


##CSM potential
```{r}
folder_path <- "/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_CSM_Potential"
files <- list.files(path = folder_path, pattern = "*.pdb", full.names = TRUE)

# Conversion vector
aa_conversion <- c(
  ALA = "A", CYS = "C", ASP = "D", GLU = "E", PHE = "F",
  GLY = "G", HIS = "H", ILE = "I", LYS = "K", LEU = "L",
  MET = "M", ASN = "N", PRO = "P", GLN = "Q", ARG = "R",
  SER = "S", THR = "T", VAL = "V", TRP = "W", TYR = "Y"
)

for (file in files) {
  cat("Processing:", file, "\n")
  
  pdb_data <- read.pdb(file)
  
  # Extract atom data from the PDB object
  df <- as.data.table(pdb_data$atom)
  
  # Extract protein name from file name
  protein_name <- strsplit(tools::file_path_sans_ext(basename(file)), "_")[[1]][1]
  df$protein_A <- protein_name
  
  # Assuming 'tempFactor' corresponds to the column you were referring to as V11
  avg_scores <- df[, .(CSM_score = mean(b, na.rm = TRUE)), by = resno]
  
  # Merge the average scores with the original df
  df <- merge(df, avg_scores, by = "resno", all.x = TRUE)
  
  # Convert the three-letter amino acid codes
  df$resname <- aa_conversion[df$resid]
  
  # Assuming Master_table exists and the mapping columns are correctly named:
  Master_table[df, CSM_potential := CSM_score, on = c(protein_A = "protein_A", aa_pos = "resno", aa_ref = "resname")]
}





```

#Add the spotone score
```{r}
PPI_spotone <- fread("/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_SPOTONE/prediction.csv")
PPI_spotone <- PPI_spotone |>
  mutate(protein_A = `Input ID`)
PPI_spotone$`Residue name` <- aa_conversion[PPI_spotone$`Residue name`]
Master_table[PPI_spotone, spotone := prediction, on = c(protein_A = "protein_A", aa_pos = "`Residue number`", aa_ref = "`Residue name")]
```

#Incorporate PPI-Hotspot
```{r}
PPI_hotspot <- fread("/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_Hotspot/PPI_Hotspot.csv")
Master_table[PPI_hotspot, hotspot := pathogenicity, on = c(protein_A = "protein_A", aa_pos = "aa_pos", aa_ref = "aa_ref", aa_alt= "aa_alt")]

Master_table$hotspot[Master_table$hotspot == "pathogenic"] <- 1
Master_table$hotspot[is.na(Master_table$hotspot)] <- 2

```

#Incorporate ClinVar 
```{r}

# Define the amino acid conversion vector
aa_conversion <- c(
  ALA = "A", CYS = "C", ASP = "D", GLU = "E", PHE = "F",
  GLY = "G", HIS = "H", ILE = "I", LYS = "K", LEU = "L",
  MET = "M", ASN = "N", PRO = "P", GLN = "Q", ARG = "R",
  SER = "S", THR = "T", VAL = "V", TRP = "W", TYR = "Y"
)

# Set the working directory to where your files are located
setwd("/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_clinvar")

# Getting the list of files in the directory that meet the specific format
file_list <- list.files(pattern = "_clinvar\\.txt$")

# Looping over each file in the file list
for (file in file_list) {
  
  # Reading the file into a data.table
  dt <- fread(file)
  
  # Renaming the column and setting its value to 1
  dt[, V16 := 1]
  setnames(dt, old = "V16", new = "pathogenicity")
  
  # Extracting the required parts from the Name column and creating new columns
  dt[, c("aa_ref", "aa_pos", "aa_alt") := 
        .(sub(".*p\\..*?([A-Za-z]+).*", "\\1", Name),  # Extracting aa_ref
          as.integer(sub(".*p\\..*?[A-Za-z]+([0-9]+).*", "\\1", Name)),  # Extracting aa_pos
          sub(".*p\\..*?[A-Za-z]+[0-9]+([A-Za-z]+).*", "\\1", Name))]  # Extracting aa_alt
  
  # Extracting the name part from the filename and creating a new column
  filename <- tools::file_path_sans_ext(basename(file))
  filename <- sub("_clinvar$", "", filename, ignore.case = TRUE)
  dt[, protein_A := filename]
  
  # Converting aa_ref and aa_alt columns using the aa_conversion vector
  dt[, aa_ref := aa_conversion[toupper(aa_ref)]]
  dt[, aa_alt := aa_conversion[toupper(aa_alt)]]
  
  # Merging with the Master_table
  # Ensure Master_table is correctly initialized before running this part
  Master_table[dt, clinvar := pathogenicity, on = c(protein_A = "protein_A", aa_pos = "aa_pos", aa_ref = "aa_ref", aa_alt= "aa_alt")]
  
}



```

#Clinvar benign
```{r}

# Define the amino acid conversion vector
aa_conversion <- c(
  ALA = "A", CYS = "C", ASP = "D", GLU = "E", PHE = "F",
  GLY = "G", HIS = "H", ILE = "I", LYS = "K", LEU = "L",
  MET = "M", ASN = "N", PRO = "P", GLN = "Q", ARG = "R",
  SER = "S", THR = "T", VAL = "V", TRP = "W", TYR = "Y"
)

# Set the working directory to where your files are located
setwd("/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_clinvar_benign")

# Getting the list of files in the directory that meet the specific format
file_list <- list.files(pattern = "_clinvar\\.txt$")

# Looping over each file in the file list
for (file in file_list) {
  
  # Reading the file into a data.table
  dt <- fread(file)
  
  dt[, V16 := 0]
  setnames(dt, old = "V16", new = "pathogenicity")
  
  # Extracting the required parts from the Name column and creating new columns
  dt[, c("aa_ref", "aa_pos", "aa_alt") := 
        .(sub(".*p\\..*?([A-Za-z]+).*", "\\1", Name),  # Extracting aa_ref
          as.integer(sub(".*p\\..*?[A-Za-z]+([0-9]+).*", "\\1", Name)),  # Extracting aa_pos
          sub(".*p\\..*?[A-Za-z]+[0-9]+([A-Za-z]+).*", "\\1", Name))]  # Extracting aa_alt
  
  # Extracting the name part from the filename and creating a new column
  filename <- tools::file_path_sans_ext(basename(file))
  filename <- sub("_clinvar$", "", filename, ignore.case = TRUE)
  dt[, protein_A := filename]
  
  # Converting aa_ref and aa_alt columns using the aa_conversion vector
  dt[, aa_ref := aa_conversion[toupper(aa_ref)]]
  dt[, aa_alt := aa_conversion[toupper(aa_alt)]]
  
  # Merging with the Master_table
  # Ensure Master_table is correctly initialized before running this part
  Master_table[dt, clinvar := pathogenicity, on = c(protein_A = "protein_A", aa_pos = "aa_pos", aa_ref = "aa_ref", aa_alt= "aa_alt")]
  
}
Master_table$clinvar[Master_table$protein_A == "CyclinA" & Master_table$aa_pos == 425 & Master_table$aa_alt == "T"& Master_table$aa_ref == "S"] <- 0

Master_table$clinvar[Master_table$protein_A == "CyclinA" & Master_table$aa_pos == 112 & Master_table$aa_alt == "E"& Master_table$aa_ref == "K"] <- 0
Master_table$clinvar[Master_table$protein_A == "IL2-Ra" & Master_table$aa_pos == 153 & Master_table$aa_alt == "I"& Master_table$aa_ref == "V"] <- 0
Master_table$clinvar[Master_table$protein_A == "Beta-Catenin" & Master_table$aa_pos == 287 & Master_table$aa_alt == "S"& Master_table$aa_ref == "N"] <- 0
Master_table$clinvar[Master_table$protein_A == "E2F2" & Master_table$aa_pos == 310 & Master_table$aa_alt == "L"& Master_table$aa_ref == "P"] <- 0


Master_table$clinvar[is.na(Master_table$clinvar)] <-2
```

#Add the CSM-potential result for BRCA2
```{r}

# Assuming Master_table is already initialized
# Master_table <- ...

# Path to the folder containing PDB files
folder_path <- "/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI_BRCA2"

# Get a list of all PDB files in the folder
pdb_files <- list.files(folder_path, pattern = "BRCA2_CSM-.*\\.pdb$", full.names = TRUE)

# Loop through each PDB file
for (pdb_file in pdb_files) {
  
  # Extract 'x' from the filename
  x <- as.numeric(gsub(".*BRCA2_CSM-(\\d+)\\.pdb$", "\\1", pdb_file))
  
  # Read the PDB file
  pdb_data <- read.pdb(pdb_file)
  
  df <- as.data.table(pdb_data$atom)
  
  if (x == 1) {
    # Usual processing (you can fill in with your specific actions)
    
  } else if (x >= 2 && x <= 11) {
    df <- df[resno >= 1200 & resno <= 1400]
    df$resno <- df$resno + (x - 1) * 200
    
  } else if (x == 12) {
    df <- df[resno >= 1200 & resno <= 1218]
    df$resno <- df$resno + 11 * 200
  }
  
  # Extract protein name and other common processing steps
  basename_file <- tools::file_path_sans_ext(basename(pdb_file))
  protein_name <- gsub("-.*", "", strsplit(basename_file, "_")[[1]][1])
  df$protein_A <- protein_name

  # Assuming 'tempFactor' corresponds to the column you were referring to as V11
  avg_scores <- df[, .(CSM_score = mean(b, na.rm = TRUE)), by = resno]
  
  # Merge the average scores with the original df
  df <- merge(df, avg_scores, by = "resno", all.x = TRUE)
  
  # Convert the three-letter amino acid codes
  df$resname <- aa_conversion[df$resid]
  
  # Assuming Master_table exists and the mapping columns are correctly named:
  Master_table[df, CSM_potential := CSM_score, on = c(protein_A = "protein_A", aa_pos = "resno", aa_ref = "resname")]
  
  
}


```

#Add grantham_distance 
```{r}
grantham_distance <- fread("/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/grantham_distance.txt")

grantham_distance <- grantham_distance |>
  select(-c("\\f0\\fs24 \\cf0", "\\", "AA" ))

grantham_distance <- as.matrix(grantham_distance)

grantham_distance <- grantham_distance[-1, ]

upper_values <- upper.tri(grantham_distance)

# Assigning the values from the upper triangle to the lower triangle
grantham_distance[lower.tri(grantham_distance)] <- t(grantham_distance)[lower.tri(grantham_distance)]

rownames(grantham_distance) <- c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")
colnames(grantham_distance) <- c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")

grantham_distance <- melt(as.matrix(grantham_distance))



colnames(grantham_distance)[colnames(grantham_distance) %in% c("Var1", "Var2", "value")] <- c("aa_ref", "aa_alt", "distance")


 Master_table[grantham_distance, grantham_distance := distance, on = c(aa_alt = "aa_alt", aa_ref = "aa_ref")]

```


```{r}
sum(Master_table$clinvar == 1)
sum(Master_table$clinvar == 0)
sum(Master_table$hotspot == 1)
sum(Master_table$clinvar == 1 & Master_table$hotspot == 1)
sum(Master_table$clinvar == 0 & Master_table$hotspot == 1)
sum(is.na(Master_table$clinvar))
```

#Change the protein name to formal protein names 
```{r}
Master_table$protein_A[Master_table$protein_A == "p53"] <- "P53"
Master_table$protein_A[Master_table$protein_A ==  "Ras"] <- 'HRAS' 
Master_table$protein_A[Master_table$protein_A ==  "Raf"] <- "RAF1"
Master_table$protein_A[Master_table$protein_A ==  "IL-2"] <- 'IL2' 
Master_table$protein_A[Master_table$protein_A ==  "IL2-Ra"] <- 'ILR2A' 
Master_table$protein_A[Master_table$protein_A ==  "CyclinA"] <- 'CCNA2' 
Master_table$protein_A[Master_table$protein_A ==  "RB"] <- 'RB' 
Master_table$protein_A[Master_table$protein_A ==  "Tcf4"] <- 'TCF4' 
Master_table$protein_A[Master_table$protein_A ==  "Beta-Catenin"] <- 'CTNNB'

```


#Make some columns relocation 
```{r}
Master_table <- Master_table |> 
  relocate (uniprot, .before = aa_ref)
  
Master_table <- Master_table |>
  relocate (grantham_distance, .after = CSM_potential)
```


#Add the teh new column to the master table used for hotspot model 
```{r}
hotspot_table  <- Master_table %>%
 mutate(label = case_when(
   clinvar == 0 ~ "benign", #Benign assumes no impact on PPI
   hotspot == 1 ~ "PPI", #PPI means disrupting PPI
   TRUE ~ NA_character_
  ))

hotspot_table$label[is.na(hotspot_table$label)] <- "None"
```


#Write the CSV
```{r}
write_csv(Master_table,"/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/ClinVar_folder/Master_table.csv")
```

#Write the CSV
```{r}
write_csv(hotspot_table,"/Users/yiyangwang/Documents/GitHub/MEDN3007_Software_Output/PPI-Hotspot_folder/hotspot_table.csv")
```

